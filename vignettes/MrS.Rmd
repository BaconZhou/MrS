---
title: "Mr.S multiple responses Subgroup Identification"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Put the title of your vignette here}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data settings

```{r}
set.seed(1234)

N = 300
np = 3
cp = 3
numX <- matrix(rnorm(N * np), N, np)
catX <- matrix(sample(5, N * cp, replace = TRUE), N, cp)
z <- sample(2, N, replace = TRUE) - 1
y1 <- numX[, 1] + 2 * z * (numX[, 3] < 0) + rnorm(N)
y2 <- numX[, 2] + 2 * z * (numX[, 3] < 0) + rnorm(N)

train <- data.frame(numX, catX, z, y1, y2)
colnames(train) <- c(paste0('n', 1:3), paste0('c', 1:3), 'z', 'Y1', 'Y2')

role <- c(rep('n', 3), rep('c', 3), 'r', 'd', 'd')
```

```{r}
library(MrS)
fit <- MrSFit(dataframe = train, role = role, bestK = 1, 
              maxDepth = 3, CVFolds = 10, CVSE = 0.5, 
              bootNum = 0, alpha = 0.05, display = TRUE, remove=TRUE) ## Change bootNum
```

```{r}
gender <- sample(c('Male', 'Female'), N, replace = TRUE)
country <- sample(c('US', 'UK', 'China', 'Japan'), N, replace = TRUE)

y3 <- numX[, 1] + numX[, 2] + 2 * z * (gender == 'Female') + rnorm(N)
y4 <- numX[, 3] + numX[, 1] + 2 * z * (gender == 'Female') + rnorm(N)
train <- data.frame(numX, gender, country, z, y3, y4)
role <- c(rep('n', 3), rep('c', 2), 'r', 'd', 'd')

fit2 <- MrSFit(dataframe = train, role = role, bestK = 3, 
              maxDepth = 3, CVFolds = 10, CVSE = 0.5, 
              bootNum = 0, alpha = 0.05, display = TRUE, remove=TRUE)
print(fit2)
```


